@page "/sales-report"
@inherits SalesReportBase
@rendermode InteractiveWebAssembly

<h3>Sales Report</h3>

@if (IsLoading)
{
    <p>Loading...</p>
}
else if (SalesReportItems == null || !SalesReportItems.Any())
{
    <p>No stock data available.</p>
}
else
{
    <div class="filters">
        <label for="venueFilter">Venue:</label>
        <InputSelect id="venueFilter" @bind-Value="VenueId">
            <option value="0">All Venues</option>
            @foreach (var venue in Lookups.VenueList)
            {
                <option value="@venue.Id">@venue.VenueName</option>
            }
        </InputSelect>

        <label for="productTypeFilter">Product Type:</label>
        <InputSelect id="productTypeFilter" @bind-Value="ProductTypeId">
            <option value="0">All Product Types</option>
            @foreach (var productType in Lookups.ProductTypeList)
            {
                <option value="@productType.Id">@productType.ProductTypeName</option>
            }
        </InputSelect>

        <label for="productFilter">Product:</label>
        <InputSelect id="productFilter" @bind-Value="ProductId">
            <option value="0">All Products</option>
            @foreach (var product in Lookups.ProductList)
            {
                <option value="@product.Id">@product.ProductName</option>
            }
        </InputSelect>
    </div>

    foreach (var venue in GroupedSalesReport)
    {
        <h4>@venue.Key</h4>
        foreach (var productType in venue.Value)
        {
            <h5>@productType.Key</h5>
            <table class="table table-striped auto-width-table">
                <tbody>
                    @foreach (var item in productType.Value)
                    {
                        <tr>
                            <td>@item.ProductName</td>
                            <td>@item.TotalSales</td>
                        </tr>
                    }
                </tbody>
            </table>
        }
    }
}
